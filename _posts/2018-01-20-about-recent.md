---
layout:     post
title:      "关于近况【2018.01.20】"
subtitle:   "近一个半月的情况汇总，以及接下来的大致安排。"
date:       2018-1-20 20:39:45 +0800
author:     "Rick"
header-img: "img/post-bg/sunshine-dog.jpg"
catalog:    true
class:      "summary"
tags:
    - 学习总结
    - 学习感悟
    - 学习安排
---

### 关于近况
***

距离上一次更新Blog，已经过了将近两个月。

具体情况是这样的。

我大致完成了 MyBatis 的各种映射文件，包括 xml 的各种 Mapper 呀，实体类呀，单元测试之类的。

总之网站的基本 DB 访问模块是搞定了，接下来设计好 API 实现各种业务逻辑，这个 RESTFul 后台就算搞定了吧？但问题就出在这里。

两个问题：1，API 如何设计；2，登陆验证如何设计。

关于 API 如何设计这一块，我 Google 上搜了半天，找到一个叫 Swagger 的工具，UI 看着也还行。

于是下载了 Node.js 搭建起了 swaggerUI 和 swagger-editor 开始翻各种资料写文档了。

期间还买了一个域名弄了个网站，里面事挺多，放在下文再说吧。

第二个问题，如何做登陆验证这个问题我考虑了有段时间了，一开始想弄个 Http Basic 认证算了，但是密码仅仅转码一下太不安全，每次请求约等于将密码明文附带一次，如果我是用户的话这种网站我肯定是不会用的呀。

所以还是考虑做 OAuth2 认证，大致流程是在服务器侧准备一个登陆页面，前端应用接到用户的登陆请求时重定向到服务器提供的登陆接口上，等待用户提交登陆信息，在登陆成功的时候附带 Token 重定向到前端应用的地址。

稍有点复杂，而且未必有必要做成这样，我的另一个想法是，反正前端也是自己做的，前端用自己的登陆页面让用户登陆，收到密码后加密一次密文向服务器请求登陆并接收 Token。

或者时间用的话两种都做吧。但是先要做一个出来把接口暴露给 swagger。

因为 swagger 有一个很方便的接口调用测试的功能，用来做 IT 测试很不错。

不过，上面说的这些的实现我这一个多月统统没有做。

原因却是另一个。

### 租了 VPS 搭建环境
***

之前一直使用的科学上网工具出了点问题，原因不可描述，总之花了点时间找解决方法，毕竟没有谷歌的日子难以想象呀，就好比失去了左膀右臂...到没那么夸张，总之有些资料还是原文的比较准的。

所以又是google了老半天，对比了各种价格，得了，还是咱自己搭建比较划算啊，而且本来就是搞这些的，乐于折腾。

遂去 Vultr 上租了个月5美元的服务器，装上 CentOS 6.5 系统，开始各种折腾。

其实还好啦，装上了 SS 继续科学上网，这个很简单，一键安装脚本很方便。

但是，有了服务器了，那还不折腾折腾？

个人网站放上去，啊，对，就是现在写的这个。之前弄的 swagger 连文档带编辑器全都丢上去。

一个 IP 不同端口可以访问不同功能，而且公网可以访问，看上去挺棒的？

是呀，挺棒的。但是还不够啊！

### 所以就弄了个域名
***

既然有了服务器，当然想弄个域名了，好吧，又是一番百度和谷歌。

机缘巧合之下看到 me 的域名优惠，一年2.8美元，便宜呀！买起！

但第二年恢复原价19.8美元，不过一年之后的事情现在不考虑，说不定到时候不租了，或者不在乎呢？

所以就有了这个域名：[critsu.me](critsu.me)

第一次弄域名，开心呀，激动呀，赶紧给绑定上服务器。

域名一点开，博客出来了！新鲜呀！

好，那再把 API 文档点出来吧？

傻眼了，点不开！

这时候还是用的端口号呢，域名后面加端口号，照理说是可以点开的，但是我用的 cloudflare 的 NDS 加速，它们处于安全考虑限制了端口访问。

而且就算能让我访问，域名后加端口号访问也太 low 了吧？

怎么办？急！在线等！

### 子域名加 Nginx 做反向代理
***

有办法，创建子域名，让子域名绑定到指定端口呗？可行吗？

不行。域名只能绑定到 IP 地址，无法详细到具体端口。而且绑定之后访问域名默认访问的是服务器的 80 端口。

如果子域名和主域名都绑定一个 IP 的话，那就是访问一个页面了。

懵了，难不成我再租台服务器绑定子域名？这不是多了笔没必要的开销？

怎么办？挺急的！在线等！

...

好吧，这时候 Nginx 就跳出来了。

这货正常情况下应该是做负载均衡的，就是在一个分布式的系统中，保证每台服务器都平均的被利用到，避免某台服务器由于集中访问 down 掉时用的。

但是它有个很好用的功能，反向代理。

简单的说就是把它绑定在80端口，然后我们设定规则，它接收到请求之后根据请求路径来判断将这个请求转发到哪个地方去，这个指定可以详细到端口上。

这个过程叫反向代理。不理解？

我们都知道，正向代理是我们将请求交给代理，让代理去真正的发送请求访问目标服务器，这个好理解。

反向代理恰恰相反，就如上面说的 nginx 的作用，我们发送给服务器的请求，在入口处被代理拦截了，由代理决定这个请求应该转发到什么地方去。

其实和我们用户没多大关系了。

但是解决了我的问题，这次我终于将子域名绑到对应的功能上了。

比如：API 文档 [docs.critsu.me](docs.critsu.me)，编辑器 [editor.critsu.me](editor.critsu.me)

这下，这件事差不多就结束了。

就是中途测试各个服务器速度，然后从阿姆斯特丹的服务器换到日本东京，然后东京服务器虽然快但是夜间经常丢包，所以换到了法国巴黎的服务器，在我目前的网络环境下表现的相对稳定，于是用到现在了。

我还弄了一个月的香港服务器，8.8美元一个月，价格较贵，但是速度真棒。不过也只打算弄一个月了。Vultr 的 VPS 按时间计费不说，还可以随时换服务器，特别人性化，相对亚洲地区提供的 VPS 服务人性化太多了。

告一段落，该回到主题了吧？

还没有。

### Python 爬虫抓数据
***

这段时间真的是很多杂事，都没时间整理。

上面一大堆事情结束之后，我打算回到正题了。

上面考虑了 API 和登陆验证之后，还有一个问题，没有基础数据。

其实也不是什么问题，随手写个 Java 小程序造一点就是啦？

不够真实，没意思，我就想着抓点数据来，像知乎啦，微博啦之类的。

于是我就想到了 python。

Python 是我一直感兴趣想学，但是没有付诸实践的一门语言。

感兴趣是因为它火呀，人工智能，深度学习，神经网络，爬虫啊什么的话题统统都围绕 python 转，而且作为一门动态语言，python 有很多方便的高级特性。

据说使用 python 是很舒心的一件事。

刚好我需要数据，python 又适合抓数据。我们就一拍即合，决定了！先学学 python 吧！

我就定了计划，一个星期熟悉 python 基础，一个星期学习爬虫，至少这半个月过去，一个简单的爬虫该出来了吧？

我是这么想的，计划现在执行到一半呢。

就目前来说，python 还是很吸引人的。

### 总结
***

上面废话说了一大堆，感觉没必要说下去了，就来个总结吧。

目前的进度是在熟悉 python 基础然后接触爬虫框架。

接下来的目标是迅速上手爬虫框架，并且爬一些简单的数据填充我们的数据库。

复杂一点的时候之后再边修正边慢慢改进。

最终丰富用户，文章，评论等数据库，保证在5w条数据左右吧。

嗯，多说无用，继续看教程去了。


